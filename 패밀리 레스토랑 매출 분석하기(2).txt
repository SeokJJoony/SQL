인구 분석하기(CUSTOMER 테이블 - customer_id, customer_name,phone_number,email,first_reg_date,sex_code,birth,job,zip_code)

*고객 인원 분석하기
SELECT COUNT(customer_id) 고객수,
       SUM(DECODE(sex_code,'F',1,0)) 여자,
       SUM(DECODE(sex_code,'M',1,0)) 남자,
       ROUND(AVG(MONTHS_BETWEEN(TO_DATE('20171231','YYYYMMDD'),TO_DATE(birth,'YYYYMMDD'))/12),1) 평균나이,
       ROUND(AVG(MONTHS_BETWEEN(TO_DATE('20171231','YYYYMMDD'),first_reg_date)),1) 평균거래기간
FROM customer;
       
나이계산법: 현재날짜와 태어난날 사이의 개월수를 계산 후 12개월로 나누어줌

*개인별 매출 분석
SELECT A.customer_id 고객아이디,
       A.customer_name 고객이름,
       COUNT(c.order_no) 주문건수,
       SUM(C.sales) 총매출,
       SUM(DECODE(C.item_id,'M0001',1,0)) 전용상품주문건수,
       SUM(DECODE(C.item_id,'M0001',C.sales,0)) 전용상품매출
FROM customer A,reservation B,order_info C
WHERE A.customer_id = B.customer_id AND B.reserv_no=C.reserv_no AND B.cancel ='N'
GROUP BY A.customer_id,a.customer_name
ORDER BY SUM(DECODE(C.item_id,'M0001',C.sales,0)) DESC;

개인별이니 개인의 정보를 그룹화하여 세부 사항들 조회
테이블 관계도를 보며 테이블관계를 파악한 뒤 where절 작성하자!!

